runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
knitr::opts_chunk$set(echo = TRUE, fig.align = "center", tidy.opts=list(width.cutoff=80),tidy=TRUE)
knitr::opts_chunk$set(echo = TRUE, fig.align = "center", tidy.opts=list(width.cutoff=80),tidy=TRUE)
packages = c('readr','sp', 'sf', 'rgdal', 'spNetwork', 'tmap', 'FNN', 'spatstat', "raster")
for (p in packages)
{
if(!require(p, character.only = T)){
install.packages(p)
}
library(p,character.only = T)
}
network <- readOGR(dsn="data/Punggol",
layer="Punggol_St",
verbose = FALSE)
network <- spTransform(network,CRS("+init=epsg:3414"))
childcare <- readOGR(dsn="data/punggol",
layer="Punggol_CC",
verbose = FALSE)
childcare <-spTransform(childcare, CRS("+init=epsg:3414"))
Bus <- readOGR(dsn="data/BusStop",
layer="BusStop_P",
verbose = FALSE)
Bus <- spTransform(Bus,CRS("+init=epsg:3414"))
MRT <- readOGR(dsn="data/MRT",
layer="MRT_P",
verbose = FALSE)
MRT <- spTransform(MRT,CRS("+init=epsg:3414"))
Schools <- read_csv("data/Schools.csv")
Schools <- st_as_sf(Schools, coords = c("Longitude", "Latitude"), crs = 4326) %>%
st_transform(crs = 3414)
Schools <- as(Schools, "Spatial")
tmap_mode('view')
tm_shape(network) +
tm_lines() +
tm_shape(childcare) +
tm_dots(col = 'red') +
tm_shape(Bus) +
tm_dots(col = 'blue') +
tm_shape(MRT) +
tm_dots(col = 'green') +
tm_shape(Schools) +
tm_dots(col='orange')
tmap_mode('view')
tm_shape(childcare) +
tm_dots(col = 'red') +
tm_shape(Bus) +
tm_dots(col = 'blue') +
tm_shape(MRT) +
tm_dots(col = 'green') +
tm_shape(Schools) +
tm_dots(col='orange')
tmap_mode('view')
tm_shape(childcare) +
tm_dots(col = 'red')
View(childcare)
tm_shape(childcare) +
tm_dots(col = 'red', text = TRUE)
View(childcare)
tm_shape(Schools) +
tm_dots(col = 'red', text = TRUE)
knitr::opts_chunk$set(echo = TRUE)
packages = c('maptools', 'sf', 'raster','spatstat', 'tmap')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p,character.only = T)
}
childcare_sf <- st_read("handson4data/child-care-services-geojson.geojson") %>%
st_transform(crs = 3414)
sg_sf <- st_read(dsn = "handson4data", layer="CostalOutline")
mpsz_sf <- st_read(dsn = "handson4data",
layer = "MP14_SUBZONE_WEB_PL")
st_crs(mpsz_sf)
mpsz_sf3414 <- st_transform(mpsz_sf,
crs = 3414)
sg_sf3414 <- st_transform(sg_sf,
crs = 3414)
tm_shape(mpsz_sf3414) +
tm_polygons() +
tm_shape(childcare_sf) +
tm_dots()
tmap_mode('view')
tm_shape(childcare_sf)+
tm_dots()
tmap_mode('plot')
childcare <- as_Spatial(childcare_sf)
mpsz <- as_Spatial(mpsz_sf3414)
sg <- as_Spatial(sg_sf3414)
childcare_sp <- as(childcare, "SpatialPoints")
sg_sp <- as(sg, "SpatialPolygons")
childcare_ppp <- as(childcare_sp, "ppp")
childcare_ppp
plot(childcare_ppp)
summary(childcare_ppp)
any(duplicated(childcare_ppp))
multiplicity(childcare_ppp)
sum(multiplicity(childcare_ppp) > 1)
tmap_mode('view')
tm_shape(childcare) +
tm_dots(alpha=0.4,
size=0.05)
tmap_mode('plot')
childcare_ppp_jit <- rjitter(childcare_ppp,
retry=TRUE,
nsim=1,
drop=TRUE)
any(duplicated(childcare_ppp_jit))
sg_owin <- as(sg_sp, "owin")
plot(sg_owin)
summary(sg_owin)
childcareSG_ppp = childcare_ppp[sg_owin]
summary(childcareSG_ppp)
kde_childcareSG_bw <- density(childcareSG_ppp,
sigma=bw.diggle,
edge=TRUE,
kernel="gaussian")
plot(kde_childcareSG_bw)
bw <- bw.diggle(childcareSG_ppp)
bw
childcareSG_ppp.km <- rescale(childcareSG_ppp, 1000, "km")
kde_childcareSG.bw <- density(childcareSG_ppp.km, sigma=bw.diggle, edge=TRUE, kernel="gaussian")
plot(kde_childcareSG.bw)
bw.CvL(childcareSG_ppp.km)
bw.scott(childcareSG_ppp.km)
bw.ppl(childcareSG_ppp.km)
bw.diggle(childcareSG_ppp.km)
kde_childcareSG.ppl <- density(childcareSG_ppp.km,
sigma=bw.ppl,
edge=TRUE,
kernel="gaussian")
par(mfrow=c(1,2))
plot(kde_childcareSG.bw, main = "bw.diggle")
plot(kde_childcareSG.ppl, main = "bw.ppl")
par(mfrow=c(2,2))
plot(density(childcareSG_ppp.km,
sigma=bw.ppl,
edge=TRUE,
kernel="gaussian"),
main="Gaussian")
plot(density(childcareSG_ppp.km,
sigma=bw.ppl,
edge=TRUE,
kernel="epanechnikov"),
main="Epanechnikov")
plot(density(childcareSG_ppp.km,
sigma=bw.ppl,
edge=TRUE,
kernel="quartic"),
main="Quartic")
plot(density(childcareSG_ppp.km,
sigma=bw.ppl,
edge=TRUE,
kernel="disc"),
main="Disc")
kde_childcareSG_600 <- density(childcareSG_ppp.km, sigma=0.6, edge=TRUE, kernel="gaussian")
plot(kde_childcareSG_600)
kde_childcareSG_adaptive <- adaptive.density(childcareSG_ppp.km, method="kernel")
plot(kde_childcareSG_adaptive)
par(mfrow=c(1,2))
plot(kde_childcareSG.bw, main = "Fixed bandwidth")
plot(kde_childcareSG_adaptive, main = "Adaptive bandwidth")
gridded_kde_childcareSG_bw <- as.SpatialGridDataFrame.im(kde_childcareSG.bw)
spplot(gridded_kde_childcareSG_bw)
kde_childcareSG_bw_raster <- raster(gridded_kde_childcareSG_bw)
kde_childcareSG_bw_raster
projection(kde_childcareSG_bw_raster) <- CRS("+init=EPSG:3414")
kde_childcareSG_bw_raster
tm_shape(kde_childcareSG_bw_raster) +
tm_raster("v") +
tm_layout(legend.position = c("right", "bottom"), frame = FALSE)
pg = mpsz[mpsz@data$PLN_AREA_N == "PUNGGOL",]
tm = mpsz[mpsz@data$PLN_AREA_N == "TAMPINES",]
ck = mpsz[mpsz@data$PLN_AREA_N == "CHOA CHU KANG",]
jw = mpsz[mpsz@data$PLN_AREA_N == "JURONG WEST",]
par(mfrow=c(2,2))
plot(pg, main = "Ponggol")
plot(tm, main = "Tampines")
plot(ck, main = "Choa Chu Kang")
plot(jw, main = "Jurong West")
pg_sp = as(pg, "SpatialPolygons")
tm_sp = as(tm, "SpatialPolygons")
ck_sp = as(ck, "SpatialPolygons")
jw_sp = as(jw, "SpatialPolygons")
pg_owin = as(pg_sp, "owin")
tm_owin = as(tm_sp, "owin")
ck_owin = as(ck_sp, "owin")
jw_owin = as(jw_sp, "owin")
childcare_pg_ppp = childcare_ppp_jit[pg_owin]
childcare_tm_ppp = childcare_ppp_jit[tm_owin]
childcare_ck_ppp = childcare_ppp_jit[ck_owin]
childcare_jw_ppp = childcare_ppp_jit[jw_owin]
childcare_pg_ppp.km = rescale(childcare_pg_ppp, 1000, "km")
childcare_tm_ppp.km = rescale(childcare_tm_ppp, 1000, "km")
childcare_ck_ppp.km = rescale(childcare_ck_ppp, 1000, "km")
childcare_jw_ppp.km = rescale(childcare_jw_ppp, 1000, "km")
par(mfrow=c(2,2))
plot(childcare_pg_ppp.km, main="Punggol")
plot(childcare_tm_ppp.km, main="Tampines")
plot(childcare_ck_ppp.km, main="Choa Chu Kang")
plot(childcare_jw_ppp.km, main="Jurong West")
par(mfrow=c(2,2))
plot(density(childcare_pg_ppp.km,
sigma=bw.diggle,
edge=TRUE,
kernel="gaussian"),
main="Punggol")
plot(density(childcare_tm_ppp.km,
sigma=bw.diggle,
edge=TRUE,
kernel="gaussian"),
main="Tempines")
plot(density(childcare_ck_ppp.km,
sigma=bw.diggle,
edge=TRUE,
kernel="gaussian"),
main="Choa Chu Kang")
plot(density(childcare_jw_ppp.km,
sigma=bw.diggle,
edge=TRUE,
kernel="gaussian"),
main="JUrong West")
par(mfrow=c(2,2))
plot(density(childcare_ck_ppp.km,
sigma=0.25,
edge=TRUE,
kernel="gaussian"),
main="Chou Chu Kang")
plot(density(childcare_jw_ppp.km,
sigma=0.25,
edge=TRUE,
kernel="gaussian"),
main="JUrong West")
plot(density(childcare_pg_ppp.km,
sigma=0.25,
edge=TRUE,
kernel="gaussian"),
main="Punggol")
plot(density(childcare_tm_ppp.km,
sigma=0.25,
edge=TRUE,
kernel="gaussian"),
main="Tampines")
clarkevans.test(childcareSG_ppp,
correction="none",
clipregion="sg_owin",
alternative=c("clustered"),
nsim=99)
clarkevans.test(childcare_ck_ppp,
correction="none",
clipregion=NULL,
alternative=c("two.sided"),
nsim=999)
clarkevans.test(childcare_tm_ppp,
correction="none",
clipregion=NULL,
alternative=c("two.sided"),
nsim=999)
G_CK = Gest(childcare_ck_ppp, correction = "border")
plot(G_CK, xlim=c(0,500))
G_CK.csr <- envelope(childcare_ck_ppp, Gest, nsim = 999)
plot(G_CK.csr)
G_tm = Gest(childcare_tm_ppp, correction = "best")
plot(G_tm)
G_tm.csr <- envelope(childcare_tm_ppp, Gest, correction = "all", nsim = 999)
plot(G_tm.csr)
F_CK = Fest(childcare_ck_ppp)
plot(F_CK)
F_CK.csr <- envelope(childcare_ck_ppp, Fest, nsim = 999)
plot(F_CK.csr)
View(mpsz)
View(mpsz_sf)
mpsz_sf <- st_read(dsn = "data",
layer = "MP14_SUBZONE_WEB_PL")
mpsz_sf <- st_read(dsn = "data",
layer = "MP14_SUBZONE_WEB_PL")
tm_shape(pg) +
tm_lines() +
tm_shape(Schools) +
tm_dots(col = 'red', text = TRUE)
tm_shape(pg) +
tm_polygons() +
tm_shape(Schools) +
tm_dots(col = 'red', text = TRUE)
tmap_mode('view')
tm_shape(pg) +
tm_polygons() +
tm_shape(Schools) +
tm_dots(col = 'red', text = TRUE)
tm_shape(pg) +
tm_polygons(alpha = 0.1) +
tm_shape(Schools) +
tm_dots(col = 'red', text = TRUE)
tm_shape(pg) +
tm_polygons(alpha = 0.1, thres.poly = 1e-05) +
tm_shape(Schools) +
tm_dots(col = 'red', text = TRUE)
tm_shape(pg) +
tm_polygons(alpha = 0.1) +
tm_shape(Schools) +
tm_dots(col = 'red', text = TRUE)
tm_shape(pg) +
tm_polygons(alpha = 0.5) +
tm_shape(Schools) +
tm_dots(col = 'red', text = TRUE)
tm_shape(pg) +
tm_polygons(alpha = 0.2) +
tm_shape(Schools) +
tm_dots(col = 'red', text = TRUE)
tm_shape(pg) +
tm_polygons(alpha = 0.1) +
tm_shape(Schools) +
tm_dots(col = 'red', text = TRUE)
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "blue") +
tm_shape(Schools) +
tm_dots(col = 'red', text = TRUE)
mpsz_sf <- st_read(dsn = "data",
layer = "MP14_SUBZONE_WEB_PL")
pg = st_union(mpsz[mpsz@data$PLN_AREA_N == "PUNGGOL",])
pg = st_union(pg)
mpsz_sf <- st_read(dsn = "data",
layer = "MP14_SUBZONE_WEB_PL")
pg = mpsz[mpsz@data$PLN_AREA_N == "PUNGGOL",]
pg = st_union(as.data.frame(pg))
mpsz_sf <- st_read(dsn = "data",
layer = "MP14_SUBZONE_WEB_PL")
pg = mpsz[mpsz@data$PLN_AREA_N == "PUNGGOL",]
pg = st_union(st_as_sf(pg))
tmap_mode('view')
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "blue") +
tm_shape(Schools) +
tm_dots(col = 'red', text = TRUE)
mpsz_sf <- st_read(dsn = "data",
layer = "MP14_SUBZONE_WEB_PL")
pg = mpsz[mpsz@data$PLN_AREA_N == "PUNGGOL",]
pg = st_union(st_as_sf(pg))
tmap_mode('view')
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red") +
tm_shape(Schools) +
tm_dots(col = 'red', text = TRUE)
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red") +
tm_shape(Schools) +
tm_dots(col = 'black', text = TRUE)
mpsz_sf <- st_read(dsn = "data",
layer = "MP14_SUBZONE_WEB_PL")
pg = mpsz[mpsz@data$PLN_AREA_N == "PUNGGOL",]
pg = st_union(st_as_sf(pg))
tmap_mode('view')
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red") +
tm_shape(Schools) +
tm_dots(col = 'black', text = TRUE)
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red", lwd = 2) +
tm_shape(Schools) +
tm_dots(col = 'black', text = TRUE)
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red", lwd = 2, shape = "smart-city.png") +
tm_shape(Schools) +
tm_dots(col = 'black', text = TRUE)
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red", lwd = 2) +
tm_shape(Schools) +
tm_symbols(shape = "smart-city.png")
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red", lwd = 2) +
tm_shape(Schools) +
tm_symbols(shape = 'smart-city.png', , size = 0.)
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red", lwd = 2) +
tm_shape(Schools) +
tm_symbols(shape = icon, size = 0.5 , size = 0.)
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red", lwd = 2) +
tm_shape(Schools) +
tm_symbols(shape = icon, size = 0.5)
mpsz_sf <- st_read(dsn = "data",
layer = "MP14_SUBZONE_WEB_PL")
pg = mpsz[mpsz@data$PLN_AREA_N == "PUNGGOL",]
pg = st_union(st_as_sf(pg))
tmap_mode('view')
icon <- tmap_icons("smart-city.png")
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red", lwd = 2) +
tm_shape(Schools) +
tm_symbols(shape = icon, size = 0.5)
icon <- tmap_icons("smart2.png")
mpsz_sf <- st_read(dsn = "data",
layer = "MP14_SUBZONE_WEB_PL")
pg = mpsz[mpsz@data$PLN_AREA_N == "PUNGGOL",]
pg = st_union(st_as_sf(pg))
tmap_mode('view')
icon <- tmap_icons("smart2.png")
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red", lwd = 2) +
tm_shape(Schools) +
tm_symbols(shape = icon, size = 0.5)
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red", lwd = 2) +
tm_shape(Schools) +
tm_symbols(shape = icon, size = 0.8)
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red", lwd = 2) +
tm_shape(Schools) +
tm_symbols(shape = icon, size = 1)
mpsz_sf <- st_read(dsn = "data",
layer = "MP14_SUBZONE_WEB_PL")
pg = mpsz[mpsz@data$PLN_AREA_N == "PUNGGOL",]
pg = st_union(st_as_sf(pg))
tmap_mode('view')
icon <- tmap_icons("fsi-header_smart-buildings.png")
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red", lwd = 2) +
tm_shape(Schools) +
tm_symbols(shape = icon, size = 1)
mpsz_sf <- st_read(dsn = "data",
layer = "MP14_SUBZONE_WEB_PL")
pg = mpsz[mpsz@data$PLN_AREA_N == "PUNGGOL",]
pg = st_union(st_as_sf(pg))
tmap_mode('view')
icon <- tmap_icons("fsi-header_smart-buildings.png")
tmap_mode('view')
tm_shape(network) +
tm_lines() +
tm_shape(childcare) +
tm_dots(col = 'red') +
tm_shape(Bus) +
tm_dots(col = 'blue') +
tm_shape(MRT) +
tm_dots(col = 'green') +
tm_shape(Schools) +
tm_dots(col='orange')
mpsz_sf <- st_read(dsn = "data",
layer = "MP14_SUBZONE_WEB_PL")
mpsz_sf <- st_read(dsn = "data",
layer = "MP14_SUBZONE_WEB_PL")
pg = mpsz[mpsz@data$PLN_AREA_N == "PUNGGOL",]
pg = st_union(st_as_sf(pg))
tmap_mode('view')
icon <- tmap_icons("fsi-header_smart-buildings.png")
mpsz_sf <- st_read(dsn = "data",
layer = "MP14_SUBZONE_WEB_PL")
pg = mpsz[mpsz@data$PLN_AREA_N == "PUNGGOL",]
pg = st_union(st_as_sf(pg))
tmap_mode('view')
icon <- tmap_icons("smart2.png")
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red", lwd = 2) +
tm_shape(Schools) +
tm_symbols(shape = icon, size = 1)
icon <- tmap_icons("smart-building.png")
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red", lwd = 2) +
tm_shape(Schools) +
tm_symbols(shape = icon, size = 1)
tm_shape(pg) +
tm_polygons(alpha = 0.1, border.col = "red", lwd = 2) +
tm_shape(Schools) +
tm_symbols(shape = icon, size = 0.7)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
shiny::runApp()
runApp()
library(rsconnect)
deployApp()
shiny::runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
class(mpsz)
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
shiny::runApp()
runApp()
runApp()
